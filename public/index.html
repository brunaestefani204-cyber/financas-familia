<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Finan√ßas da Fam√≠lia</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;background:#f2f4f7;color:#333}
header{background:#1f2937;color:#fff;padding:20px;text-align:center}
nav{display:flex;background:#111827}
nav button{flex:1;padding:14px;border:none;background:none;color:#9ca3af;font-weight:500;cursor:pointer}
nav button.active{color:#fff;border-bottom:3px solid #22c55e}
main{max-width:1000px;margin:auto;padding:20px}
section{display:none}
section.active{display:block}
.card,.box{background:#fff;border-radius:12px;padding:16px;margin-bottom:16px;box-shadow:0 2px 6px rgba(0,0,0,.08)}
.cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:12px}
input,select,button{width:100%;padding:10px;border-radius:8px;border:1px solid #d1d5db;margin-top:6px}
button{background:#22c55e;color:#fff;font-weight:bold;border:none;cursor:pointer}
button.delete{background:#dc2626;margin-top:10px}
.progress{background:#e5e7eb;border-radius:8px;height:10px;overflow:hidden;margin-top:6px}
.progress div{background:#22c55e;height:100%}
ul{padding-left:18px}
.small{font-size:13px;color:#6b7280}
</style>
</head>

<body>

<header>
<h1>Finan√ßas da Fam√≠lia</h1>
<p>Controle financeiro anual</p>
</header>

<nav>
<button class="active" onclick="trocarAba('painel',this)">Painel</button>
<button onclick="trocarAba('transacoes',this)">Transa√ß√µes</button>
<button onclick="trocarAba('metas',this)">Metas</button>
<button onclick="trocarAba('categorias',this)">Categorias</button>
</nav>

<main>

<!-- PAINEL -->
<section id="painel" class="active">
<div class="cards">
<div class="card"><strong>Entradas</strong><div id="entradas">R$ 0,00</div></div>
<div class="card"><strong>Despesas</strong><div id="despesas">R$ 0,00</div></div>
<div class="card"><strong>Investimentos</strong><div id="investimentos">R$ 0,00</div></div>
<div class="card"><strong>Metas (Ano)</strong><div id="totalMetas">R$ 0,00</div></div>
<div class="card"><strong>Saldo do m√™s</strong><div id="saldo">R$ 0,00</div></div>
</div>
</section>

<!-- TRANSA√á√ïES -->
<section id="transacoes">
<div class="box">
<h3>Nova Transa√ß√£o</h3>

<select id="tipo">
<option value="entrada">Entrada</option>
<option value="despesa">Despesa</option>
<option value="investimento">Investimento</option>
</select>

<input id="valor" type="number" placeholder="Valor">

<select id="categoria"></select>

<button onclick="addTransacao()">Adicionar</button>
</div>

<div class="box">
<h3>Lan√ßamentos</h3>
<ul id="listaTransacoes"></ul>
</div>
</section>

<!-- METAS -->
<section id="metas">
<div class="box">
<h3>üéØ Nova Meta Anual</h3>
<input id="nomeMeta" placeholder="Nome da meta">
<input id="valorMeta" type="number" placeholder="Valor total">
<button onclick="addMeta()">Adicionar Meta</button>
</div>
<div id="listaMetas"></div>
</section>

<!-- CATEGORIAS -->
<section id="categorias">
<div class="box">
<h3>üè∑ Categorias</h3>

<input id="novaCategoria" placeholder="Nome da categoria">

<select id="classificacaoCategoria">
<option value="Adulto">Adulto</option>
<option value="Crian√ßa">Crian√ßa</option>
<option value="Fam√≠lia">Fam√≠lia</option>
</select>

<button onclick="addCategoria()">Adicionar Categoria</button>

<ul id="listaCategorias"></ul>
</div>
</section>

</main>

<script>
/* DADOS */
let categorias = JSON.parse(localStorage.getItem("categorias")) || [
  {nome:"Alimenta√ß√£o",classificacao:"Fam√≠lia"},
  {nome:"Moradia",classificacao:"Fam√≠lia"},
  {nome:"Educa√ß√£o",classificacao:"Crian√ßa"},
  {nome:"Lazer",classificacao:"Fam√≠lia"}
]

let transacoes = JSON.parse(localStorage.getItem("transacoes")) || []
let metas = JSON.parse(localStorage.getItem("metas")) || []

/* ABA */
function trocarAba(id,btn){
document.querySelectorAll("section").forEach(s=>s.classList.remove("active"))
document.getElementById(id).classList.add("active")
document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"))
btn.classList.add("active")
}

/* SALVAR */
function salvar(){
localStorage.setItem("categorias",JSON.stringify(categorias))
localStorage.setItem("transacoes",JSON.stringify(transacoes))
localStorage.setItem("metas",JSON.stringify(metas))
}

/* CATEGORIAS */
function renderCategorias(){
  categoria.innerHTML = categorias
    .map(c=>`<option value="${c.nome}">${c.nome}</option>`)
    .join("")

  listaCategorias.innerHTML = categorias
    .map(c=>`
      <li>
        <strong>${c.nome}</strong>
        <div class="small">${c.classificacao || "Fam√≠lia"}</div>
      </li>
    `)
    .join("")
}

function addCategoria(){
let nome=novaCategoria.value.trim()
let clas=classificacaoCategoria.value
if(!nome)return
categorias.push({nome,classificacao:clas})
novaCategoria.value=""
salvar();renderCategorias()
}

/* TRANSA√á√ïES */
function addTransacao(){
let v=Number(valor.value)
if(!v)return

let cat = categorias.find(c=>c.nome===categoria.value)

transacoes.push({
  tipo:tipo.value,
  valor:v,
  categoria:cat.nome,
  classificacao:cat.classificacao
})

valor.value=""
salvar();renderTransacoes();atualizar()
}

function renderTransacoes(){
listaTransacoes.innerHTML=""
transacoes.forEach(t=>{
listaTransacoes.innerHTML+=`
<li>
<strong>${t.tipo.toUpperCase()}</strong> ‚Ä¢ ${t.categoria}
<div class="small">${t.classificacao} ‚Ä¢ R$ ${t.valor.toFixed(2)}</div>
</li>`
})
}

/* METAS */
function addMeta(){
let n=nomeMeta.value.trim()
let t=Number(valorMeta.value)
if(!n||!t)return
metas.push({nome:n,total:t,acumulado:0})
nomeMeta.value="";valorMeta.value=""
salvar();renderMetas()
}

function excluirMeta(i){
metas.splice(i,1)
salvar();renderMetas();atualizar()
}

/* ATUALIZAR PAINEL */
function atualizar(){
let e=transacoes.filter(t=>t.tipo==="entrada").reduce((a,b)=>a+b.valor,0)
let d=transacoes.filter(t=>t.tipo==="despesa").reduce((a,b)=>a+b.valor,0)
let i=transacoes.filter(t=>t.tipo==="investimento").reduce((a,b)=>a+b.valor,0)
let sobra=e-d-i

if(sobra>0 && metas.length){
let m=metas.find(m=>m.acumulado<m.total)
if(m){
let falta=m.total-m.acumulado
m.acumulado+=Math.min(falta,sobra)
}
}

entradas.innerText=e.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})
despesas.innerText=d.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})
investimentos.innerText=i.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})
totalMetas.innerText=metas.reduce((a,b)=>a+b.acumulado,0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})
saldo.innerText=(sobra>0?0:sobra).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})

salvar();renderMetas()
}

/* METAS UI */
function renderMetas(){
listaMetas.innerHTML=""
metas.forEach((m,i)=>{
let p=(m.acumulado/m.total)*100
listaMetas.innerHTML+=`
<div class="box">
<strong>${m.nome}</strong>
<p>${m.acumulado.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})} / ${m.total.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}</p>
<div class="progress"><div style="width:${p}%"></div></div>
<button class="delete" onclick="excluirMeta(${i})">Excluir Meta</button>
</div>`
})
}

/* INIT */
renderCategorias()
renderTransacoes()
renderMetas()
atualizar()
</script>

</body>
</html>
