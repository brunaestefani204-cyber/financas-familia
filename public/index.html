<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Finan√ßas da Fam√≠lia</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;background:#f2f4f7;margin:0;color:#333}
header{background:#1f2937;color:#fff;padding:16px;text-align:center}
nav{display:flex;background:#111827}
nav button{flex:1;padding:14px;background:none;border:none;color:#9ca3af;cursor:pointer}
nav button.active{color:#fff;border-bottom:3px solid #22c55e}
main{padding:16px;max-width:900px;margin:auto}
section{display:none}
section.active{display:block}
.box,.card{background:#fff;border-radius:12px;padding:16px;margin-bottom:16px;box-shadow:0 2px 6px rgba(0,0,0,.08)}
.cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:12px}
input,select,button{width:100%;padding:10px;margin-top:6px;margin-bottom:10px;border-radius:8px;border:1px solid #d1d5db}
button{background:#22c55e;color:#fff;font-weight:bold;border:none}
.progress{background:#e5e7eb;border-radius:8px;overflow:hidden;height:10px;margin-top:6px}
.progress div{background:#22c55e;height:100%}
</style>
</head>

<body>

<header>
<h1>Finan√ßas da Fam√≠lia</h1>
<p>Controle financeiro anual</p>
</header>

<nav>
<button class="active" onclick="mostrarAba('painel',this)">Painel</button>
<button onclick="mostrarAba('transacoes',this)">Transa√ß√µes</button>
<button onclick="mostrarAba('metas',this)">Metas</button>
<button onclick="mostrarAba('categorias',this)">Categorias</button>
</nav>

<main>

<section id="painel" class="active">
<div class="cards">
<div class="card"><h4>Entradas</h4><strong id="entradas">R$ 0,00</strong></div>
<div class="card"><h4>Despesas</h4><strong id="despesas">R$ 0,00</strong></div>
<div class="card"><h4>Investimentos</h4><strong id="investimentos">R$ 0,00</strong></div>
<div class="card"><h4>Metas (Ano)</h4><strong id="totalMetas">R$ 0,00</strong></div>
<div class="card"><h4>Saldo do m√™s</h4><strong id="saldo">R$ 0,00</strong></div>
</div>
</section>

<section id="transacoes">
<div class="box">
<select id="tipo">
<option value="entrada">Entrada</option>
<option value="despesa">Despesa</option>
<option value="investimento">Investimento</option>
</select>
<input id="valor" type="number" placeholder="Valor">
<button onclick="addTransacao()">Adicionar</button>
</div>
</section>

<section id="metas">
<div class="box">
<h3>üéØ Nova Meta Anual</h3>
<input id="nomeMeta" placeholder="Nome da meta">
<input id="valorMeta" type="number" placeholder="Valor total">
<button onclick="addMeta()">Adicionar Meta</button>
</div>
<div id="listaMetas"></div>
</section>

<section id="categorias">
<div class="box">
<p>Categorias e integrantes mantidos.</p>
</div>
</section>

</main>

<script>
let transacoes=JSON.parse(localStorage.getItem("transacoes"))||[]
let metas=JSON.parse(localStorage.getItem("metas"))||[]

function mostrarAba(id,btn){
document.querySelectorAll("section").forEach(s=>s.classList.remove("active"))
document.getElementById(id).classList.add("active")
document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"))
btn.classList.add("active")
}

function salvar(){
localStorage.setItem("transacoes",JSON.stringify(transacoes))
localStorage.setItem("metas",JSON.stringify(metas))
}

function addTransacao(){
let tipo=tipo.value
let v=Number(valor.value)
if(!v)return
transacoes.push({tipo:v>0?tipo:null,valor:v})
valor.value=""
salvar();atualizar()
}

function addMeta(){
let nome=nomeMeta.value.trim()
let total=Number(valorMeta.value)
if(!nome||!total)return
metas.push({nome,total,acumulado:0})
nomeMeta.value="";valorMeta.value=""
salvar();renderMetas()
}

function atualizar(){
let e=transacoes.filter(t=>t.tipo=="entrada").reduce((a,b)=>a+b.valor,0)
let d=transacoes.filter(t=>t.tipo=="despesa").reduce((a,b)=>a+b.valor,0)
let i=transacoes.filter(t=>t.tipo=="investimento").reduce((a,b)=>a+b.valor,0)
let sobra=e-d-i
let metasMes=sobra>0?sobra:0

if(metasMes>0 && metas.length){
let m=metas.find(m=>m.acumulado<m.total)
if(m){
let falta=m.total-m.acumulado
let add=Math.min(falta,metasMes)
m.acumulado+=add
}
}

entradas.innerText=e.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})
despesas.innerText=d.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})
investimentos.innerText=i.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})
totalMetas.innerText=metas.reduce((a,b)=>a+b.acumulado,0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})
saldo.innerText=(sobra>0?0:sobra).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})

salvar();renderMetas()
}

function renderMetas(){
listaMetas.innerHTML=""
metas.forEach(m=>{
let p=(m.acumulado/m.total)*100
listaMetas.innerHTML+=`
<div class="box">
<strong>${m.nome}</strong>
<p>${m.acumulado.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})} / ${m.total.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}</p>
<div class="progress"><div style="width:${p}%"></div></div>
</div>`
})
}

atualizar()
</script>

</body>
</html>
